server:
  port: 40006
  servlet:
    context-path: /auth
  shutdown: graceful
  tomcat:
    threads:
      max: 200
      min-spare: 10

management:
  server:
    port: 40007
  endpoints:
    web:
      base-path: /actuator
      exposure:
        include: 'health,info,prometheus,metrics'
  endpoint:
    health:
      probes:
        enabled: true
      liveness-state:
        enabled: true
      readiness-state:
        enabled: true

spring:
  application:
    name: authsrv

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  config:
    import: optional:nacos:${spring.application.name}-${spring.profiles.active}.yml

  cloud:
    nacos:
      server-addr: ${NACOS_HOST:nexora-nacos}:${NACOS_PORT:8848}
      config:
        enabled: ${NACOS_CONFIG_ENABLED:true}
        refresh-enabled: true
        username: ${NACOS_USERNAME:}
        password: ${NACOS_PASSWORD:}
        namespace: ${spring.profiles.active}
        context-path: /
      discovery:
        enabled: ${NACOS_DISCOVERY_ENABLED:true}
        register-enabled: true
        username: ${NACOS_USERNAME:}
        password: ${NACOS_PASSWORD:}
        namespace: ${spring.profiles.active}
        context-path: /
        weight: ${SERVICE_WEIGHT:1}

  # JPA configuration (基础设施配置，不迁移到 Nacos)
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        format_sql: true

  threads:
    virtual:
      enabled: true

  lifecycle:
    timeout-per-shutdown-phase: 30s

# SpringDoc OpenAPI configuration (基础设施配置)
springdoc:
  api-docs:
    enabled: true
    path: /api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
